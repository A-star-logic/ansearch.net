---
import Layout from '@layouts/LayoutDefault.astro';
import { getCollection, type CollectionEntry } from 'astro:content';

export async function getStaticPaths() {
  const posts: CollectionEntry<'blog'>[] = await getCollection('blog');

  const paths = posts.map((post) => {
    const lang = post.data.lang;
    const slug = post.slug;
    return {
      params: { lang, slug },
    };
  });

  return paths;
}

const posts: CollectionEntry<'blog'>[] = await getCollection('blog');

const entry = posts.find((post) => post.slug === `${Astro.params.slug}`);

if (!entry) {
  throw new Error(`Article introuvable: ${Astro.params.slug}`);
}

const { Content } = await entry.render();
//const meta = entry.data;
---

<Layout>
  <Content />
</Layout>
